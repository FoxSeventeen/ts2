import os
import csv

DATA_DIR = os.path.dirname(os.path.abspath(__file__))  # å½“å‰è„šæœ¬ç›®å½•

# ç¡®ä¿æ•°æ®ç›®å½•å­˜åœ¨ï¼ˆè‡ªåŠ¨åˆ›å»ºå¤šå±‚ç›®å½•ï¼‰
os.makedirs(DATA_DIR, exist_ok=True)

# ==================== 1. å†™å…¥User.csv ====================
user_header = ["uid", "uname", "utype", "uphone", "uprovince", "ucity", "uaddress"]
user_data = [
    ["U001", "å¼ ä¸‰", "æ™®é€šç”¨æˆ·", "13800138000", "åŒ—äº¬å¸‚", "åŒ—äº¬å¸‚", "æœé˜³åŒºå»ºå›½è·¯88å·"],
    ["U002", "æå››", "æ™®é€šç”¨æˆ·", "13900139000", "ä¸Šæµ·å¸‚", "ä¸Šæµ·å¸‚", "æµ¦ä¸œæ–°åŒºå¼ æ±Ÿè·¯15å·"],
    ["U003", "ç‹äº”", "å•†å®¶ç”¨æˆ·", "13700137000", "å¹¿ä¸œçœ", "å¹¿å·å¸‚", "å¤©æ²³åŒºå¤©æ²³è·¯385å·"],
    ["U004", "èµµå…­", "æ™®é€šç”¨æˆ·", "13600136000", "æ±Ÿè‹çœ", "å—äº¬å¸‚", "é¼“æ¥¼åŒºä¸­å±±è·¯2å·"],
    ["U005", "å­™ä¸ƒ", "æ™®é€šç”¨æˆ·", "13500135000", "æµ™æ±Ÿçœ", "æ­å·å¸‚", "è¥¿æ¹–åŒºæ–‡ä¸‰è·¯55å·"],
    ["U006", "å‘¨å…«", "æ™®é€šç”¨æˆ·", "13400134000", "å››å·çœ", "æˆéƒ½å¸‚", "é”¦æ±ŸåŒºæ˜¥ç†™è·¯18å·"],
    ["U007", "å´ä¹", "æ™®é€šç”¨æˆ·", "13300133000", "æ¹–åŒ—çœ", "æ­¦æ±‰å¸‚", "æ´ªå±±åŒºå…‰è°·å¤§é“7å·"],
    ["U008", "éƒ‘å", "å•†å®¶ç”¨æˆ·", "13200132000", "å±±ä¸œçœ", "é’å²›å¸‚", "å¸‚å—åŒºé¦™æ¸¯ä¸­è·¯66å·"],
    ["U009", "é’±åä¸€", "æ™®é€šç”¨æˆ·", "13100131000", "é™•è¥¿çœ", "è¥¿å®‰å¸‚", "é›å¡”åŒºé«˜æ–°è·¯25å·"]
]

user_file = os.path.join(DATA_DIR, "User.csv")
with open(user_file, "w", newline="", encoding="utf-8") as f:
    writer = csv.writer(f)
    writer.writerow(user_header)  # å†™å…¥è¡¨å¤´
    writer.writerows(user_data)   # å†™å…¥æ•°æ®è¡Œ
print(f"âœ… User.csv å·²åˆ›å»ºï¼Œè·¯å¾„ï¼š{user_file}")

# ==================== 2. å†™å…¥ExpressBranch.csv ====================
branch_header = ["branchId", "branchName", "coordinateRange", "branchType", "contactPhone"]
branch_data = [
    ["BR001", "åŒ—äº¬æœé˜³ä¸­è½¬ä¸­å¿ƒ", "116.45,39.92,116.50,39.95", "ä¸­è½¬ä¸­å¿ƒ", "13800138001"],
    ["BR002", "ä¸Šæµ·æµ¦ä¸œæ´¾é€ç‚¹", "121.50,31.23,121.55,31.26", "æ´¾é€ç‚¹", "13900139002"],
    ["BR003", "å¹¿å·å¤©æ²³ç½‘ç‚¹", "113.35,23.12,113.40,23.15", "æ´¾é€ç‚¹", "13700137003"],
    ["BR004", "æ­å·è¥¿æ¹–ä¸­è½¬ä¸­å¿ƒ", "120.15,30.25,120.20,30.28", "ä¸­è½¬ä¸­å¿ƒ", "13600136004"],
    ["BR005", "å—äº¬é¼“æ¥¼æ´¾é€ç‚¹", "118.78,32.04,118.83,32.07", "æ´¾é€ç‚¹", "13500135005"]
]

branch_file = os.path.join(DATA_DIR, "ExpressBranch.csv")
with open(branch_file, "w", newline="", encoding="utf-8") as f:
    writer = csv.writer(f)
    writer.writerow(branch_header)
    writer.writerows(branch_data)
print(f"âœ… ExpressBranch.csv å·²åˆ›å»ºï¼Œè·¯å¾„ï¼š{branch_file}")

# ==================== 3. å†™å…¥ExpressOrder.csv ====================
order_header = ["orderId", "senderId", "receiverId", "goodsName", "goodsWeight", "sendBranchId", "targetBranchId", "sendTime", "orderStatus"]
order_data = [
    ["EXP20250520001", "U001", "U002", "ç¬”è®°æœ¬ç”µè„‘", "2.3", "BR001", "BR003", "2025-05-20 09:30:00", "1"],
    ["EXP20250520002", "U003", "U004", "æ´—è¡£æ¶²æ•´ç®±", "8.5", "BR002", "BR005", "2025-05-20 10:15:00", "2"],
    ["EXP20250520003", "U005", "U006", "å¤å­£çŸ­è¢–Tæ¤", "1.2", "BR001", "BR004", "2025-05-20 11:20:00", "0"],
    ["EXP20250520004", "U002", "U007", "å„¿ç«¥ç©å…·å¥—è£…", "3.0", "BR003", "BR001", "2025-05-20 14:00:00", "3"],
    ["EXP20250520005", "U008", "U009", "ç²¾è£…å›¾ä¹¦10å†Œ", "4.5", "BR004", "BR002", "2025-05-20 16:45:00", "4"]
]

order_file = os.path.join(DATA_DIR, "ExpressOrder.csv")
with open(order_file, "w", newline="", encoding="utf-8") as f:
    writer = csv.writer(f)
    writer.writerow(order_header)
    writer.writerows(order_data)
print(f"âœ… ExpressOrder.csv å·²åˆ›å»ºï¼Œè·¯å¾„ï¼š{order_file}")

print("\nğŸ‰ æ‰€æœ‰æµ‹è¯•æ•°æ®æ–‡ä»¶å·²æˆåŠŸç”Ÿæˆï¼")
print(f"æ•°æ®æ–‡ä»¶å­˜å‚¨è·¯å¾„ï¼š{os.path.abspath(DATA_DIR)}")